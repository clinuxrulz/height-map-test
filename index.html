<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>height map test</title>
  </head>
  <body>
    <canvas style="width: 100%;" id="canvas" width="320" height="200">
    </canvas>
    <script type="module">
      import init, { main } from "./pkg/height_map_test.js";
      let angle = 0.0;
      init().then(() => {
        let canvas = document.getElementById("canvas");
        let ctx = canvas.getContext("2d");
        let imgData = ctx.createImageData(320, 200);
        let screen = new Uint32Array(imgData.data.buffer);
        let render = () => {
          main(screen, angle);
          ctx.putImageData(imgData, 0, 0);
          angle += 0.2;
          if (angle >= 360.0) {
            angle -= 360.0;
          }
          requestAnimationFrame(render);
        };
        requestAnimationFrame(render);
      });
    </script>
  </body>
</html>
